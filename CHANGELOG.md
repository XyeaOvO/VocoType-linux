# Changelog

All notable changes to VoCoType Linux IBus will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [2.1.2] - 2026-01-21

### Fixed

- **ä¿®å¤**ï¼šCtrl+Space æ— æ³•åˆ‡æ¢ Rime ascii_mode çš„é—®é¢˜
  - **é—®é¢˜**ï¼šç”¨æˆ·åœ¨ `default.custom.yaml` ä¸­é…ç½® `Ctrl+Space` åˆ‡æ¢ `ascii_mode`ï¼Œä½†åœ¨ VoCoType ä¸­ä¸ç”Ÿæ•ˆ
  - **åŸå› **ï¼šIBus å’Œ Fcitx5 åç«¯é”™è¯¯åœ°å°† `Ctrl+Space` ä½œä¸ºè¾“å…¥æ³•åˆ‡æ¢çƒ­é”®æ‹¦æˆªï¼Œå¯¼è‡´æŒ‰é”®æœªä¼ é€’ç»™ Rime
  - **è§£å†³**ï¼šç§»é™¤ `Ctrl+Space` æ‹¦æˆªï¼Œä»…ä¿ç•™ `Super+Space` ä½œä¸ºè¾“å…¥æ³•åˆ‡æ¢çƒ­é”®ï¼Œå…è®¸ Rime æŒ‰ç…§ç”¨æˆ·é…ç½®å¤„ç† `Ctrl+Space`
  - **å½±å“èŒƒå›´**ï¼šIBus (`ibus/engine.py:574-579`) å’Œ Fcitx5 (`fcitx5/addon/vocotype.cpp:441-447`) åç«¯

## [2.1.1] - 2026-01-20

### Changed

- **Python ç‰ˆæœ¬è¦æ±‚è°ƒæ•´**ï¼š
  - æ”¯æŒç‰ˆæœ¬ï¼šPython 3.11â€“3.12
  - **ä¸å†æ”¯æŒ Python 3.10**

- **PyGObject ç‰ˆæœ¬é™åˆ¶**ï¼š
  - é™åˆ¶ä¸º `<3.51`ï¼Œé¿å… Ubuntu 22.04 å› ç¼ºå°‘ `libgirepository-2` å¯¼è‡´å®‰è£…å¤±è´¥

- **å®‰è£…è„šæœ¬æ”¹è¿›**ï¼š
  - é¡¹ç›®/ç”¨æˆ·çº§è™šæ‹Ÿç¯å¢ƒä¼˜å…ˆä½¿ç”¨ `uv` å·¥å…·
  - ç³»ç»Ÿ Python å®‰è£…ä»…åœ¨ç”¨æˆ·æ˜ç¡®é€‰æ‹©æ—¶æ‰éå†

### Fixed

- **ä¿®å¤**ï¼šFcitx5 æ’ä»¶è·¯å¾„æ£€æµ‹
  - è¡¥å…… `/usr/lib/x86_64-linux-gnu/fcitx5` è·¯å¾„ï¼ˆUbuntu ç³»ç»Ÿä¿®å¤ï¼‰
  - ç¡®ä¿åœ¨ Debian/Ubuntu ç³»ç»Ÿä¸Šæ­£ç¡®æ£€æµ‹æ’ä»¶ç›®å½•

### Documentation

- **æ›´æ–°**ï¼šDebian/Ubuntu ä¾èµ–è¯´æ˜
  - è¯´æ˜ Ubuntu 22.04 çš„ librime/ibus-rime ç‰ˆæœ¬åæ—§
  - å»ºè®®ä½¿ç”¨ Rime åŠŸèƒ½æ—¶æ‰‹åŠ¨ç¼–è¯‘å®‰è£… librime + ibus-rime

### Compatibility Notes

- âš ï¸ **ä¸å…¼å®¹å˜æ›´**ï¼šä¸å†æ”¯æŒ Python 3.10ï¼Œè¯·ä½¿ç”¨ Python 3.11 æˆ– 3.12
- âš ï¸ **Ubuntu 22.04**ï¼šè‹¥ä½¿ç”¨ Rime åŠŸèƒ½ï¼Œå»ºè®®æ‰‹åŠ¨ç¼–è¯‘å®‰è£… librime + ibus-rime

## [2.1.0]

### Changed

- **ä»£ç é‡æ„**ï¼šé‡æ•´ä»£ç ç»“æ„ï¼Œæå‡å¯ç»´æŠ¤æ€§
- **åŠŸèƒ½å¢å¼º**ï¼šå¢åŠ è¾“å…¥æ–¹æ¡ˆé€‰æ‹©åŠŸèƒ½

### Fixed

- **ä¿®å¤**ï¼šå¤šä¸ªå®‰è£…ä¸ç¨³å®šé—®é¢˜
  - æå‡å®‰è£…æˆåŠŸç‡
  - æ”¹è¿›ä¾èµ–æ£€æµ‹å’Œå®‰è£…æµç¨‹

## [2.0.0]

### Added

- **Fcitx5 æ”¯æŒ**ï¼šæ–°å¢ Fcitx5 è¾“å…¥æ³•æ¡†æ¶æ”¯æŒ
  - é¡¹ç›®ä» `vocotype-ibus` æ›´åä¸º `vocotype-linux`
  - åŒæ—¶æ”¯æŒ IBus å’Œ Fcitx5 ä¸¤ç§è¾“å…¥æ³•æ¡†æ¶
  - ç”¨æˆ·å¯æ ¹æ®ç³»ç»Ÿç¯å¢ƒé€‰æ‹©å¯¹åº”çš„å®‰è£…è„šæœ¬

### Changed

- **é¡¹ç›®æ›´å**ï¼š`vocotype-ibus` â†’ `vocotype-linux`
  - åæ˜ å¤šæ¡†æ¶æ”¯æŒçš„å®šä½
  - æ›´å¹¿æ³›çš„ Linux æ¡Œé¢ç¯å¢ƒå…¼å®¹æ€§

## [1.1.0] - 2026-01-02

### Added

#### ğŸ¯ Rime æ‹¼éŸ³è¾“å…¥é›†æˆï¼ˆå¯é€‰ï¼‰

- **å®Œæ•´ç‰ˆè¾“å…¥æ³•**ï¼šç°åœ¨å¯ä»¥é€‰æ‹©å®‰è£…"å®Œæ•´ç‰ˆ"ï¼Œåœ¨åŒä¸€ä¸ªè¾“å…¥æ³•å†…åŒæ—¶æ”¯æŒï¼š
  - **F9 è¯­éŸ³è¾“å…¥**ï¼šæŒ‰ä½ F9 è¯´è¯ï¼Œæ¾å¼€åè‡ªåŠ¨è¯†åˆ«
  - **æ‹¼éŸ³è¾“å…¥**ï¼šç›´æ¥æ‰“å­—ï¼ŒRime å¼•æ“å¤„ç†æ‹¼éŸ³è¾“å…¥å¹¶æ˜¾ç¤ºå€™é€‰è¯
  - ä¸€ä¸ªè¾“å…¥æ³•æå®šæ‰€æœ‰éœ€æ±‚ï¼Œæ— éœ€åˆ‡æ¢

- **çº¯è¯­éŸ³ç‰ˆï¼ˆæ¨èæ–°æ‰‹ï¼‰**ï¼šä¿æŒåŸæœ‰çš„çº¯è¯­éŸ³è¾“å…¥åŠŸèƒ½
  - ä»… F9 è¯­éŸ³è¾“å…¥
  - ä¾èµ–å°‘ï¼Œå®‰è£…ç®€å•
  - å¯ä¸å…¶ä»–æ‹¼éŸ³è¾“å…¥æ³•ï¼ˆå¦‚ ibus-rimeï¼‰é…åˆä½¿ç”¨

- **Rime é…ç½®å…±äº«**ï¼šå®Œæ•´ç‰ˆä½¿ç”¨ `~/.config/ibus/rime/` ä½œä¸ºé…ç½®ç›®å½•
  - ä¸ ibus-rime å…±äº«è¯åº“å’Œé…ç½®
  - å¦‚æœå·²ç»é…ç½®è¿‡ ibus-rimeï¼Œæ‰€æœ‰è®¾ç½®å’Œè¯åº“éƒ½ä¼šè‡ªåŠ¨ç»§æ‰¿
  - æ— éœ€é‡å¤é…ç½®

- **ä¼˜é›…é™çº§**ï¼šå³ä½¿å®‰è£…äº†å®Œæ•´ç‰ˆï¼Œå¦‚æœ pyrime ä¸å¯ç”¨ï¼Œå¼•æ“ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°çº¯è¯­éŸ³æ¨¡å¼

#### ğŸš€ å®‰è£…ä½“éªŒæ”¹è¿›

- **äº¤äº’å¼å®‰è£…å‘å¯¼**ï¼š
  ```
  è¯·é€‰æ‹©å®‰è£…ç‰ˆæœ¬ï¼š
    [1] çº¯è¯­éŸ³ç‰ˆï¼ˆæ¨èæ–°æ‰‹ï¼‰- ä»…è¯­éŸ³è¾“å…¥ï¼Œä¾èµ–å°‘
    [2] å®Œæ•´ç‰ˆ - è¯­éŸ³ + Rime æ‹¼éŸ³è¾“å…¥ï¼Œä¸€ä¸ªè¾“å…¥æ³•å…¨æå®š
  ```

- **å¤šå¹³å°è‡ªåŠ¨æ£€æµ‹ä¸å®‰è£…**ï¼š
  - è‡ªåŠ¨æ£€æµ‹ Linux å‘è¡Œç‰ˆï¼ˆFedora/RHELã€Debian/Ubuntuã€Arch Linuxï¼‰
  - æä¾›å¯¹åº”çš„ç³»ç»Ÿä¾èµ–å®‰è£…å‘½ä»¤
  - å¯é€‰æ‹©è‡ªåŠ¨å®‰è£…æˆ–æ‰‹åŠ¨å®‰è£…ç³»ç»Ÿä¾èµ–
  - æ™ºèƒ½æ£€æµ‹ librime-devel æ˜¯å¦å·²å®‰è£…ï¼Œé¿å…é‡å¤å®‰è£…

- **Python ç¯å¢ƒé€‰æ‹©**ï¼šå®‰è£…æ—¶å¯é€‰æ‹©ï¼š
  - é¡¹ç›®è™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
  - ç”¨æˆ·çº§è™šæ‹Ÿç¯å¢ƒ
  - ç³»ç»Ÿ Python

- **ä¾èµ–ç®¡ç†ä¼˜åŒ–**ï¼š
  - ä¼˜å…ˆä½¿ç”¨ `uv` å·¥å…·ï¼ˆå¦‚æœå¯ç”¨ï¼‰åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå’Œå®‰è£…ä¾èµ–
  - è‡ªåŠ¨å›é€€åˆ° `python3 -m venv` å’Œ `pip`

### Changed

#### âš™ï¸ æŠ€æœ¯æ¶æ„æ”¹è¿›

- **Rime é›†æˆæ–¹å¼å®Œå…¨é‡å†™**ï¼š
  - **ç§»é™¤**ï¼šåŸºäº IBus InputContext ä»£ç†æ–¹å¼ï¼ˆå­˜åœ¨æ¶æ„ç¼ºé™·ï¼‰
  - **æ–°å¢**ï¼šç›´æ¥ä½¿ç”¨ `pyrime` åº“è°ƒç”¨ `librime`
  - **ä¼˜åŠ¿**ï¼š
    - æ— é˜»å¡ã€æ— è¶…æ—¶é—®é¢˜
    - æ›´é«˜æ•ˆçš„æŒ‰é”®å¤„ç†
    - æ›´å¯é çš„å€™é€‰è¯æ˜¾ç¤º

- **æŒ‰é”®å¤„ç†ä¼˜åŒ–**ï¼š
  - æ­£ç¡®çš„ IBus åˆ° Rime modifier mask è½¬æ¢
  - æ”¯æŒ Shiftã€Ctrlã€Altã€Lock ç­‰ä¿®é¥°é”®
  - ä¸å†æ‰‹åŠ¨è°ƒç”¨ `post_process_key_event()`ï¼ˆç”± IBus æ¡†æ¶è‡ªåŠ¨å¤„ç†ï¼‰

- **UI æ›´æ–°æ”¹è¿›**ï¼š
  - ä½¿ç”¨ Rime Context API ç›´æ¥è·å–é¢„ç¼–è¾‘æ–‡æœ¬å’Œå€™é€‰è¯
  - æ­£ç¡®è®¾ç½®ä¸‹åˆ’çº¿æ ·å¼å’Œå…‰æ ‡ä½ç½®
  - æ”¯æŒå€™é€‰è¯æ³¨é‡Šï¼ˆcommentï¼‰æ˜¾ç¤º

#### ğŸ“¦ ä¾èµ–å˜æ›´

- **æ ¸å¿ƒä¾èµ–**ï¼ˆå¿…éœ€ï¼‰ï¼š
  ```toml
  sounddevice==0.5.2
  librosa==0.11.0
  soundfile==0.13.1
  funasr_onnx==0.4.1
  jieba==0.42.1
  PyGObject>=3.42.0
  modelscope==1.30.0
  torch>=2.9.1
  ```

- **å¯é€‰ä¾èµ–**ï¼ˆæ–°å¢ï¼‰ï¼š
  ```toml
  [project.optional-dependencies]
  rime = ["pyrime>=0.2.1"]
  full = ["pyrime>=0.2.1"]
  ```

- **ç³»ç»Ÿä¾èµ–**ï¼ˆå®Œæ•´ç‰ˆéœ€è¦ï¼‰ï¼š
  - Fedora/RHEL: `librime-devel ibus-rime`
  - Debian/Ubuntu: `librime-dev ibus-rime`
  - Arch Linux: `librime ibus-rime`

### Fixed

- **ä¿®å¤**ï¼šå¼•æ“æ¿€æ´»è¶…æ—¶é—®é¢˜
  - **é—®é¢˜**ï¼šä½¿ç”¨ InputContext ä»£ç† Rime æ—¶ï¼Œ`set_engine()` è°ƒç”¨é˜»å¡å¯¼è‡´è¶…æ—¶
  - **è§£å†³**ï¼šåˆ‡æ¢åˆ° pyrime ç›´æ¥é›†æˆï¼Œå½»åº•æ¶ˆé™¤é˜»å¡

- **ä¿®å¤**ï¼šGObject è­¦å‘Š
  - **é—®é¢˜**ï¼š`g_object_is_floating: assertion 'G_IS_OBJECT (object)' failed`
  - **åŸå› **ï¼šé”™è¯¯åœ°æ‰‹åŠ¨è°ƒç”¨ `post_process_key_event()`
  - **è§£å†³**ï¼šç§»é™¤æ‰‹åŠ¨è°ƒç”¨ï¼Œç”± IBus æ¡†æ¶è‡ªåŠ¨å¤„ç†

- **ä¿®å¤**ï¼špyrime äºŒè¿›åˆ¶å…¼å®¹æ€§é—®é¢˜
  - **é—®é¢˜**ï¼šPython 3.12 æ„å»ºçš„ .so æ–‡ä»¶æ— æ³•åœ¨ Python 3.13 ä¸­ä½¿ç”¨
  - **è§£å†³**ï¼šä¸ºæ¯ä¸ª Python ç‰ˆæœ¬æ­£ç¡®ç¼–è¯‘å¯¹åº”çš„äºŒè¿›åˆ¶æ¨¡å—

### Documentation

- **å®Œå…¨é‡å†™ README**ï¼š
  - æ–°å¢ä¸¤ç§ç‰ˆæœ¬å¯¹æ¯”è¡¨
  - è¯¦ç»†çš„åˆ†ç‰ˆæœ¬å®‰è£…æŒ‡å—
  - åŠŸèƒ½å¯¹æ¯”å’Œä½¿ç”¨åœºæ™¯è¯´æ˜
  - å¸¸è§é—®é¢˜è§£ç­”æ›´æ–°

- **å®‰è£…è„šæœ¬æ”¹è¿›**ï¼š
  - æ¸…æ™°çš„ç‰ˆæœ¬é€‰æ‹©æç¤º
  - å¤šå¹³å°æ”¯æŒè¯´æ˜
  - ä¾èµ–å®‰è£…å¼•å¯¼

## [1.0.0] - Initial Release

### Added

- åŸºäº VoCoType æ ¸å¿ƒå¼•æ“çš„ IBus è¾“å…¥æ³•å®ç°
- F9 PTT (Push-to-Talk) è¯­éŸ³è¾“å…¥
- åŸºäº FunASR Paraformer çš„ç¦»çº¿è¯­éŸ³è¯†åˆ«
- äº¤äº’å¼éŸ³é¢‘è®¾å¤‡é…ç½®å‘å¯¼
- è‡ªåŠ¨æ¨¡å‹ä¸‹è½½
- ç”¨æˆ·çº§å®‰è£…æ”¯æŒï¼ˆ`~/.local/`ï¼‰

### Features

- 100% ç¦»çº¿ï¼Œéšç§å®‰å…¨
- 0.1 ç§’çº§è¯†åˆ«å“åº”
- 700MB å†…å­˜å ç”¨
- çº¯ CPU æ¨ç†ï¼Œæ— éœ€ GPU
- ä¸­è‹±æ··åˆè¾“å…¥æ”¯æŒ
- è¯†åˆ«å‡†ç¡®ç‡ >95%

---

## å‡çº§æŒ‡å—

### ä» 1.0.0 å‡çº§åˆ° 1.1.0

#### é€‰é¡¹ 1ï¼šä¿æŒçº¯è¯­éŸ³ç‰ˆ

å¦‚æœæ‚¨åªéœ€è¦è¯­éŸ³è¾“å…¥åŠŸèƒ½ï¼Œæ— éœ€ä»»ä½•æ“ä½œã€‚ç°æœ‰å®‰è£…ç»§ç»­æ­£å¸¸å·¥ä½œã€‚

#### é€‰é¡¹ 2ï¼šå‡çº§åˆ°å®Œæ•´ç‰ˆï¼ˆè¯­éŸ³ + Rimeï¼‰

1. **å®‰è£…ç³»ç»Ÿä¾èµ–**ï¼š

   ```bash
   # Fedora / RHEL
   sudo dnf install librime-devel ibus-rime

   # Ubuntu / Debian
   sudo apt install librime-dev ibus-rime

   # Arch Linux
   sudo pacman -S librime ibus-rime
   ```

2. **å®‰è£… pyrime**ï¼š

   ```bash
   # å¦‚æœä½¿ç”¨é¡¹ç›®è™šæ‹Ÿç¯å¢ƒ
   .venv/bin/pip install pyrime

   # å¦‚æœä½¿ç”¨ç”¨æˆ·çº§è™šæ‹Ÿç¯å¢ƒ
   ~/.local/share/vocotype/.venv/bin/pip install pyrime
   ```

3. **é‡å¯ IBus**ï¼š

   ```bash
   ibus restart
   ```

4. **éªŒè¯**ï¼šåˆ‡æ¢åˆ° VoCoType è¾“å…¥æ³•ï¼Œå°è¯•ï¼š
   - æŒ‰ä½ F9 è¯´è¯ï¼ˆè¯­éŸ³è¾“å…¥ï¼‰
   - ç›´æ¥æ‰“å­—ï¼ˆæ‹¼éŸ³è¾“å…¥ï¼‰

#### å…¨æ–°å®‰è£…

å»ºè®®é‡æ–°è¿è¡Œå®‰è£…è„šæœ¬ï¼Œå®ƒä¼šå¼•å¯¼æ‚¨é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬ï¼š

```bash
cd vocotype-cli
./scripts/install-ibus.sh
```

---

## æŠ€æœ¯ç»†èŠ‚

### Rime é›†æˆå®ç°

**v1.0.0ï¼ˆå·²ç§»é™¤ï¼‰**ï¼š
```python
# âŒ æ—§æ–¹æ³•ï¼šé€šè¿‡ InputContext ä»£ç†
self._rime_context = IBus.InputContext(...)
self._rime_context.set_engine("rime")  # é˜»å¡ï¼
```

**v1.1.0ï¼ˆå½“å‰ï¼‰**ï¼š
```python
# âœ… æ–°æ–¹æ³•ï¼šç›´æ¥ä½¿ç”¨ pyrime
from pyrime.session import Session
self._rime_session = Session(traits=traits, api=api)
handled = self._rime_session.process_key(keyval, rime_mask)
```

### é…ç½®ç›®å½•ç»“æ„

```
~/.config/
â”œâ”€â”€ vocotype/
â”‚   â””â”€â”€ audio.conf          # VoCoType éŸ³é¢‘é…ç½®
â””â”€â”€ ibus/
    â””â”€â”€ rime/               # Rime é…ç½®ï¼ˆä¸ ibus-rime å…±äº«ï¼‰
        â”œâ”€â”€ default.yaml
        â”œâ”€â”€ luna_pinyin.yaml
        â””â”€â”€ ...

~/.local/share/
â”œâ”€â”€ vocotype/               # VoCoType å®‰è£…ç›®å½•
â”‚   â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ ibus/
â”‚   â””â”€â”€ .venv/
â””â”€â”€ ibus/
    â””â”€â”€ component/
        â””â”€â”€ vocotype.xml    # IBus ç»„ä»¶é…ç½®
```

---

## è‡´è°¢

- **[pyrime](https://github.com/TypeDuck-HK/pyrime)** - ä¼˜ç§€çš„ librime Python ç»‘å®š
- **[ibus-rime](https://github.com/rime/ibus-rime)** - Rime IBus è¾“å…¥æ³•ï¼Œä¸ºæˆ‘ä»¬çš„é›†æˆæä¾›äº†é…ç½®å…±äº«åŸºç¡€
- **[RIME](https://rime.im/)** - å¼ºå¤§çš„å¼€æºä¸­æ–‡è¾“å…¥æ³•å¼•æ“
